#!/bin/bash

IF="$1"
if [ -z "$IF" ]; then
	IF=$(sudo ip -j a \
		| jq ".[] | .ifname" \
		| grep -E '^"(eth|enp)' \
		| sort \
		| head -n 1)
fi

IF="${IF//\"/}"
if [ -z "$IF" ]; then
	>&2 echo network interface not found
	exit 1
fi

sudo ip -j a \
	| jq ".[] | select (.ifname == \"${IF}\") | .addr_info[] | select (.family == \"inet\") | .local" \
	| sed 's#"##g'
